# DAO의 확장

## 관심사의 분리 : 관심사 마다 각자 변화의 특징을 가지고 있어 변화의 성격이 다른 것을 분리해야함

## 클래스의 분리

- 관심사가 다른 클래스를 완전히 독립된 클래스로 만듬
- 여기서는 DB 커넥션과 관련된 클래스를 SimpleConnectionMaker 이름의 클래스로 만듬
- UserDao는 new 키워드를 사용해 SimpleConnectionMaker의 오브젝트를 만들어 메소드를 이용해 가져옴

₩₩₩
public class UserDao {
private SimpleConnectionMaker simpleConnectionMaker;

    public UserDao() {
        simpleConnectionMaker = new SimpleConnectionMaker();
    }

    public void add(User user) throws ClassNotFoundException, SQLException{

        Connection conn = simpleConnectionMaker.makeNewConnection();

        String sql = "insert into users values(?,?,?)";

        PreparedStatement ps = conn.prepareStatement(sql);
        ps.setString(1, user.getId());
        ps.setString(2, user.getName());
        ps.setString(3, user.getPassword());
        ps.executeUpdate();

        if(ps!=null) ps.close();
        if(conn!=null) conn.close();
    }

    public User get(String id) throws ClassNotFoundException, SQLException{

        Connection conn = simpleConnectionMaker.makeNewConnection();

        String sql = "select * from users where id = ?";

        PreparedStatement ps = conn.prepareStatement(sql);
        ps.setString(1, id);

        ResultSet rs = ps.executeQuery();

        if(rs.next()){
            User user = new User();
            user.setId(rs.getString("id"));
            user.setName(rs.getString("name"));
            user.setPassword(rs.getString("password"));

            if(rs!=null) rs.close();
            if(ps!=null) ps.close();
            if(conn!=null) conn.close();
            return user;
        } else {
            return null;
        }
    }

}
₩₩₩
